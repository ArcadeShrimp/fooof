<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>04: FOOOFGroup &#8212; fooof 1.0.0-dev documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="05: Tuning &amp; Troubleshooting" href="plot_05-Troubleshooting.html" />
    <link rel="prev" title="03: FOOOF Algorithm" href="plot_03-FOOOFAlgorithm.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          fooof</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0.0-dev</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../api.html">API</a></li>
                <li><a href="../faq.html">FAQ</a></li>
                <li><a href="index.html">Tutorial</a></li>
                <li><a href="../auto_examples/index.html">Examples</a></li>
                <li><a href="https://github.com/voytekresearch/fooof">GitHub</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../readme_link.html">README</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../contents.html">Table of Contents</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Click <a class="reference internal" href="#sphx-glr-download-auto-tutorials-plot-04-fooofgroup-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="fooofgroup">
<span id="sphx-glr-auto-tutorials-plot-04-fooofgroup-py"></span><h1>04: FOOOFGroup<a class="headerlink" href="#fooofgroup" title="Permalink to this headline">¶</a></h1>
<p>This tutorial covers running FOOOF across multiple power spectra, using FOOOFGroup, an object derived from the base FOOOF object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># FOOOF imports: get FOOOF &amp; FOOOFGroup objects</span>
<span class="kn">from</span> <span class="nn">fooof</span> <span class="kn">import</span> <a href="../generated/fooof.FOOOFGroup.html#fooof.FOOOFGroup" title="View documentation for fooof.FOOOFGroup"><span class="n">FOOOFGroup</span></a>

<span class="c1"># Import some utilities for synthesizing some test data</span>
<span class="kn">from</span> <span class="nn">fooof.synth</span> <span class="kn">import</span> <a href="../generated/fooof.synth.gen_group_power_spectra.html#fooof.synth.gen_group_power_spectra" title="View documentation for fooof.synth.gen_group_power_spectra"><span class="n">gen_group_power_spectra</span></a><span class="p">,</span> <a href="../generated/fooof.synth.param_sampler.html#fooof.synth.param_sampler" title="View documentation for fooof.synth.param_sampler"><span class="n">param_sampler</span></a>
</pre></div>
</div>
<div class="section" id="synthesizing-power-spectra">
<h2>Synthesizing Power Spectra<a class="headerlink" href="#synthesizing-power-spectra" title="Permalink to this headline">¶</a></h2>
<p>FOOOF includes some support for creating synthetic power-spectra, that mimic real data.</p>
<p>Here we will use that functionality to create a matrix of power spectra to test with.</p>
<p>Here we will use a helper function called <code class="xref py py-func docutils literal notranslate"><span class="pre">param_sampler()</span></code> that takes a list of possible parameters, and creates an object that randomly samples from them to generate power spectra.</p>
<p>If you would like to generate single power spectra, you can use <code class="xref py py-func docutils literal notranslate"><span class="pre">gen_power_spectrum()</span></code>, also in fooof.synth.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Settings for synthesizing power spectra</span>
<span class="n">n_psds</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">f_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>

<span class="c1"># Set some options for background parameters</span>
<span class="c1">#  Generated spectra will have an offset of either [20, 50, 35], and corresponding slope of [2., 2.5, 1.5]</span>
<span class="n">bgp_opts</span> <span class="o">=</span> <a href="../generated/fooof.synth.param_sampler.html#fooof.synth.param_sampler" title="View documentation for fooof.synth.param_sampler"><span class="n">param_sampler</span></a><span class="p">([[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">35</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]])</span>

<span class="c1"># Set some options for peak parameters</span>
<span class="c1">#  Generated power spectra will have either no peaks, a 10 Hz peak, or a 10 Hz &amp; 20 Hz peak</span>
<span class="n">gauss_opts</span> <span class="o">=</span> <a href="../generated/fooof.synth.param_sampler.html#fooof.synth.param_sampler" title="View documentation for fooof.synth.param_sampler"><span class="n">param_sampler</span></a><span class="p">([[],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</pre></div>
</div>
<p>We can now feed these settings into <code class="xref py py-func docutils literal notranslate"><span class="pre">gen_group_power_spectra()</span></code>, that will generate a group of power spectra for us.</p>
<p>Note that this function also returns a list of the parameters used to generate each power spectrum.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate the group of synthetic spectra</span>
<span class="c1">#  Note that this function also returns a list of the parameters for each func</span>
<span class="n">freqs</span><span class="p">,</span> <span class="n">spectra</span><span class="p">,</span> <span class="n">syn_params</span> <span class="o">=</span> <a href="../generated/fooof.synth.gen_group_power_spectra.html#fooof.synth.gen_group_power_spectra" title="View documentation for fooof.synth.gen_group_power_spectra"><span class="n">gen_group_power_spectra</span></a><span class="p">(</span><span class="n">n_psds</span><span class="p">,</span> <span class="n">f_range</span><span class="p">,</span> <span class="n">bgp_opts</span><span class="p">,</span> <span class="n">gauss_opts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h2>FOOOFGroup<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>The FOOOFGroup object is very similar to the FOOOF object (programmatically, it inherits from the FOOOF object), and can be used in the same way.</p>
<p>The main difference is that instead of running across a single power spectrum, it operates across 2D matrices containing multiple power spectra.</p>
<p>Note that by ‘group’ we mean merely to refer to a group of power-spectra, not necessarily to a group in terms of multiple subjects or similar. Most likely, a FOOOFGroup will be run across a collection of spectra from across channels, and/or across trials, within or across subjects.</p>
<p>The main difference with the FOOOFGroup object, is that it also contains a ‘power_spectra’ attribute, which stores the matrix of power-spectra to be fit, and collects fit results into a ‘group_results’ attribute. Otherwise, FOOOFGroup supports all the same functionality, accessed in the same way as the FOOOF object.</p>
<p>Internally, it runs the exact same fitting procedure, per spectrum, as the FOOOF object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize a FOOOFGroup object - it accepts all the same settings as FOOOF</span>
<span class="n">fg</span> <span class="o">=</span> <a href="../generated/fooof.FOOOFGroup.html#fooof.FOOOFGroup" title="View documentation for fooof.FOOOFGroup"><span class="n">FOOOFGroup</span></a><span class="p">(</span><span class="n">peak_width_limits</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">min_peak_amplitude</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">max_n_peaks</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit a group of power spectra with the .fit() method</span>
<span class="c1">#  The key difference (compared to FOOOF) is that it takes a 2D array of spectra</span>
<span class="c1">#     This matrix should have the shape of [n_spectra, n_freqs]</span>
<span class="n">fg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">spectra</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Running FOOOFGroup across 10 power spectra.
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print out results</span>
<span class="n">fg</span><span class="o">.</span><span class="n">print_results</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>==================================================================================================

                                       FOOOF - GROUP RESULTS

                             Number of power spectra in the Group: 10

                        The model was run on the frequency range 3 - 40 Hz
                                 Frequency Resolution is 0.50 Hz

                              Power spectra were fit without a knee.

                                     Background Slope Values
                              Min: 1.4978, Max: 2.5284, Mean: 1.9197

                         In total 14 peaks were extracted from the group

                                     Goodness of fit metrics:
                            R2s -  Min: 0.9987, Max: 0.9999, Mean: 0.9994
                         Errors -  Min: 0.0039, Max: 0.0159, Mean: 0.0107

==================================================================================================
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot a summary of the results across the group</span>
<span class="c1">#  Note: given the simulations, we expect slopes at {1.5, 2.0. 2.5} and peaks around {10, 20}</span>
<span class="n">fg</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_04-FOOOFGroup_001.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_04-FOOOFGroup_001.png" />
<p>Just as with the FOOOF object, you can call the convenience method ‘report’ to run the fitting, and print results &amp; plots, printing out the same as above.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># You can also save out PDFs reports for FOOOFGroup fits, same as with FOOOF</span>
<span class="n">fg</span><span class="o">.</span><span class="n">save_report</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check what the generated report looks like</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">IFrame</span>
<span class="n">IFrame</span><span class="p">(</span><span class="s2">&quot;FOOOFGroup_Report.pdf&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">950</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">1200</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="fooofgroup-data">
<h2>FOOOFGroup Data<a class="headerlink" href="#fooofgroup-data" title="Permalink to this headline">¶</a></h2>
<p>FOOOFGroup collects fits across power spectra into a list of FOOOFResults objects.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># As it runs, FOOOFGroup collects each fit results in &#39;group_results&#39;</span>
<span class="c1">#  &#39;group_results&#39; is a list of FOOOFResult objects</span>
<span class="n">fg</span><span class="o">.</span><span class="n">group_results</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>get_all_data</strong></p>
<p>To collect data across all model fits, and to select specific data results from this data you can use the <code class="xref py py-func docutils literal notranslate"><span class="pre">get_all_data()</span></code> method. This method lets you extract specific results by specifying a field, as a string, and (optionally) a specific column of that data, also as a string (or, optionally, as an integer index).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract aperiodic data</span>
<span class="n">bgps</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">get_all_data</span><span class="p">(</span><span class="s1">&#39;background_params&#39;</span><span class="p">)</span>
<span class="n">sls</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">get_all_data</span><span class="p">(</span><span class="s1">&#39;background_params&#39;</span><span class="p">,</span> <span class="s1">&#39;slope&#39;</span><span class="p">)</span>

<span class="c1"># Extract peak data</span>
<span class="n">peaks</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">get_all_data</span><span class="p">(</span><span class="s1">&#39;peak_params&#39;</span><span class="p">)</span>
<span class="n">cfs</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">get_all_data</span><span class="p">(</span><span class="s1">&#39;peak_params&#39;</span><span class="p">,</span> <span class="s1">&#39;CF&#39;</span><span class="p">)</span>

<span class="c1"># Extract metadata about the model fit</span>
<span class="n">errors</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">get_all_data</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">)</span>
<span class="n">r2s</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">get_all_data</span><span class="p">(</span><span class="s1">&#39;r_squared&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># The full list of data you can specify is available in the documentation of :func:`get_all_data`</span>
<span class="k">print</span><span class="p">(</span><span class="n">fg</span><span class="o">.</span><span class="n">get_all_data</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Return all data for a specified attribute across the group.

        Parameters
        ----------
        name : {&#39;background_params&#39;, &#39;peak_params&#39;, &#39;error&#39;, &#39;r_squared&#39;, &#39;gaussian_params&#39;}
            Name of the data field to extract across the group.
        col : {&#39;CF&#39;, &#39;Amp&#39;, &#39;BW&#39;, &#39;intercept&#39;, &#39;knee&#39;, &#39;slope&#39;} or int, optional
            Column name / index to extract from selected data, if requested.
                Only used for name of {&#39;background_params&#39;, &#39;peak_params&#39;, &#39;gaussian_params&#39;}.

        Returns
        -------
        out : ndarray
            Requested data.

        Notes
        -----
        For further description of the data you can extract, check the FOOOFResults documentation.
            For example:
                $ print(fg[0].__doc__)
</pre></div>
</div>
<p>More information about the data you can extract is also documented in the FOOOFResults object</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Grab a particular FOOOFResults item</span>
<span class="c1">#  Note that as a shortcut, you can index the FOOOFGroup object directly to access &#39;group_results&#39;</span>
<span class="n">f_res</span> <span class="o">=</span> <span class="n">fg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Check the documentation for the FOOOFResults - with full descriptions of the resulting data.</span>
<span class="k">print</span><span class="p">(</span><span class="n">f_res</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>The resulting parameters and associated data of a FOOOF model fit.

Attributes
----------
background_params : 1d array, len 2 or 3
    Parameters that define the background fit. As [Intercept, (Knee), Slope].
        The knee parameter is only included if background fit with knee. Otherwise, length is 2.
peak_params : 2d array, shape=[n_peaks, 3]
    Fitted parameter values for the peaks. Each row is a peak, as [CF, Amp, BW].
r_squared : float
    R-squared of the fit between the input power spectrum and the full model fit.
error : float
    Root mean squared error of the full model fit.
gaussian_params : 2d array, shape=[n_peaks, 3]
    Parameters that define the gaussian fit(s). Each row is a gaussian, as [mean, amp, std].
</pre></div>
</div>
<hr class="docutils" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check out the extracted slope values</span>
<span class="c1">#  Note that this extraction will return an array of length equal to the number of model fits</span>
<span class="c1">#    The model fit from which each data element originated is the index of this vector</span>
<span class="k">print</span><span class="p">(</span><span class="n">sls</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[2.00058046 2.52843476 2.03312828 2.51733613 1.53437325 1.49834705
 2.02793971 1.5290573  1.49781173 2.03025015]
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check the fit center-frequencies and slope values</span>
<span class="c1">#  Note that when you extract peak data, an additional column is appended, specifying which model fit it came from</span>
<span class="k">print</span><span class="p">(</span><span class="n">cfs</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[10.10887058  1.        ]
 [19.97985234  1.        ]
 [10.13185081  2.        ]
 [20.07414083  2.        ]
 [10.05386942  3.        ]
 [10.11166601  4.        ]
 [19.9968381   4.        ]
 [10.11682903  6.        ]
 [20.00885048  6.        ]
 [10.11978614  7.        ]
 [19.32681264  7.        ]
 [23.69809263  7.        ]
 [10.1146671   9.        ]
 [19.96252164  9.        ]]
</pre></div>
</div>
</div>
<div class="section" id="saving-loading-with-fooofgroup">
<h2>Saving &amp; Loading with FOOOFGroup<a class="headerlink" href="#saving-loading-with-fooofgroup" title="Permalink to this headline">¶</a></h2>
<p>FOOOFGroup also support saving and loading, with same options as saving from FOOOF.</p>
<p>The only difference in saving FOOOFGroup, is that it saves out a ‘jsonlines’ file, in which each line is a JSON object, saving the specified data and results for a single power spectrum.</p>
<p>Note that saving settings together with results will save out duplicated settings to each line in the output file, corresponding to each individual spectrum in the group, and so is somewhat inefficient. It is more parsimonious to save out a single settings file, and a separate file that includes the results.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Save out FOOOFGroup settings &amp; results (separately)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;FG_settings&#39;</span><span class="p">,</span> <span class="n">save_settings</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;FG_results&#39;</span><span class="p">,</span> <span class="n">save_results</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># You can then reload this group data</span>
<span class="n">nfg</span> <span class="o">=</span> <a href="../generated/fooof.FOOOFGroup.html#fooof.FOOOFGroup" title="View documentation for fooof.FOOOFGroup"><span class="n">FOOOFGroup</span></a><span class="p">()</span>
<span class="n">nfg</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;FG_results&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print results to check that the loaded group</span>
<span class="n">nfg</span><span class="o">.</span><span class="n">print_results</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>==================================================================================================

                                       FOOOF - GROUP RESULTS

                             Number of power spectra in the Group: 10

                        The model was run on the frequency range 3 - 40 Hz
                                 Frequency Resolution is 0.50 Hz

                              Power spectra were fit without a knee.

                                     Background Slope Values
                              Min: 1.4978, Max: 2.5284, Mean: 1.9197

                         In total 14 peaks were extracted from the group

                                     Goodness of fit metrics:
                            R2s -  Min: 0.9987, Max: 0.9999, Mean: 0.9994
                         Errors -  Min: 0.0039, Max: 0.0159, Mean: 0.0107

==================================================================================================
</pre></div>
</div>
</div>
<div class="section" id="parallel-support">
<h2>Parallel Support<a class="headerlink" href="#parallel-support" title="Permalink to this headline">¶</a></h2>
<p>FOOOFGroup also has support for running in parallel, which can speed things up as each power spectrum is fit independently.</p>
<p>The fit method includes an optional parameter ‘n_jobs’, which if set at 1 (as default), will run FOOOF linearly. If you set this parameter to some other integer, fitting will launch ‘n_jobs’ number of jobs, in parallel. Setting n_jobs to -1 will launch in parallel across all available cores.</p>
<p>Note, however, that running FOOOF in parallel does not gaurantee a quicker runtime overall. The computation time per FOOOF-fit scales with the frequency range fit over, and the ‘complexity’ of the power spectra, in terms of number of peaks. For relatively small numbers of power spectra (less than ~100), across relatively small frequency ranges (say ~3-40Hz), running in parallel may offer no appreciable speed up.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run FOOOF fit across a group of power spectra in parallel, using all cores</span>
<span class="n">fg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">spectra</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Running FOOOFGroup across 10 power spectra.
</pre></div>
</div>
</div>
<div class="section" id="plotting-individual-fits">
<h2>Plotting Individual Fits<a class="headerlink" href="#plotting-individual-fits" title="Permalink to this headline">¶</a></h2>
<p>When running FOOOF across a group of power spectra, results are stored as the FOOOFResults, which stores (only) the results of the model fit, not the full model fits themselves.</p>
<p>To examine individual model fits, FOOOFGroup can regenerate FOOOF objects for individual power spectra, with the full model available for visualization.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract a particular spectrum, specified by index to a FOOOF object</span>
<span class="c1">#  Here we also specify to regenerate the the full model fit, from the results</span>
<span class="n">fm</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">get_fooof</span><span class="p">(</span><span class="n">ind</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">regenerate</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print results and plot extracted FOOOF model fit</span>
<span class="n">fm</span><span class="o">.</span><span class="n">print_results</span><span class="p">()</span>
<span class="n">fm</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_04-FOOOFGroup_002.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_04-FOOOFGroup_002.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>==================================================================================================

                                   FOOOF - POWER SPECTRUM MODEL

                        The model was run on the frequency range 3 - 40 Hz
                                 Frequency Resolution is 0.50 Hz

                             Background Parameters (offset, slope):
                                         20.0655, 2.0331

                                       2 peaks were found:
                                CF:  10.13, Amp:  0.475, BW:  3.67
                                CF:  20.07, Amp:  0.271, BW:  7.18

                                     Goodness of fit metrics:
                                    R^2 of model fit is 0.9993
                                Root mean squared error is 0.0144

==================================================================================================
</pre></div>
</div>
<p><strong>Total running time of the script:</strong> ( 0 minutes  0.573 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-tutorials-plot-04-fooofgroup-py">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../_downloads/plot_04-FOOOFGroup.py" download=""><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_04-FOOOFGroup.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../_downloads/plot_04-FOOOFGroup.ipynb" download=""><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_04-FOOOFGroup.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018 - VoytekLab.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.<br/>
    </p>
  </div>
</footer>
  </body>
</html>